apiVersion: v1
kind: Secret
metadata:
  name: {{ include "memora.fullname" . }}-secret
  labels:
    {{- include "memora.labels" . | nindent 4 }}
type: Opaque
data:
  {{- if and .Values.api.secrets (hasKey .Values.api.secrets "MEMORY_LLM_API_KEY") }}
  llm-api-key: {{ .Values.api.secrets.MEMORY_LLM_API_KEY | b64enc | quote }}
  {{- end }}
  {{- if and .Values.api.secrets (hasKey .Values.api.secrets "MEMORY_LLM_BASE_URL") }}
  llm-base-url: {{ .Values.api.secrets.MEMORY_LLM_BASE_URL | b64enc | quote }}
  {{- end }}
  {{- if not .Values.postgresql.enabled }}
  {{- if .Values.postgresql.external.password }}
  postgres-password: {{ .Values.postgresql.external.password | b64enc | quote }}
  {{- end }}
  {{- end }}
